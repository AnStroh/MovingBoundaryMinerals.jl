<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>List of functions · MovingBoundaryMinerals.jl</title><meta name="title" content="List of functions · MovingBoundaryMinerals.jl"/><meta property="og:title" content="List of functions · MovingBoundaryMinerals.jl"/><meta property="twitter:title" content="List of functions · MovingBoundaryMinerals.jl"/><meta name="description" content="Documentation for MovingBoundaryMinerals.jl."/><meta property="og:description" content="Documentation for MovingBoundaryMinerals.jl."/><meta property="twitter:description" content="Documentation for MovingBoundaryMinerals.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MovingBoundaryMinerals.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../listexamples/">List of examples</a></li><li class="is-active"><a class="tocitem" href>List of functions</a></li><li><a class="tocitem" href="../authors/">Authors</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../security/">Security</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>List of functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>List of functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/main/docs/src/man/listfunctions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="List-of-all-functions"><a class="docs-heading-anchor" href="#List-of-all-functions">List of all functions</a><a id="List-of-all-functions-1"></a><a class="docs-heading-anchor-permalink" href="#List-of-all-functions" title="Permalink"></a></h1><p>Here an overview of all functions:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.advect_interface_regrid!-NTuple{8, Any}" href="#MovingBoundaryMinerals.advect_interface_regrid!-NTuple{8, Any}"><code>MovingBoundaryMinerals.advect_interface_regrid!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">advect_interface_regrid!(Ri, V_ip, dt, x_left, x_right, C_left, C_right, nr)</code></pre><p>Update the interface position and calculate new grids based on the advection velocity. Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>Ri::Float64</code>: Radii [interface    total length in [m].</li><li><code>V_ip::Float64</code>: Advection velocity in [m/s].</li><li><code>dt::Float64</code>: Time step in [s].</li><li><code>x_left::Vector{Float64}</code>: Left distance nodes in [m].</li><li><code>x_right::Vector{Float64}</code>: Right distance nodes in [m].</li><li><code>C_left::Vector{Float64}</code>: Composition values on the left nodes in [-].</li><li><code>C_right::Vector{Float64}</code>: Composition values on the right nodes in [-].</li><li><code>nr::Vector{Int}</code>: Resolution of the left and the right grid.</li></ul><p><strong>Returns</strong></p><ul><li><code>Fl_regrid::Int</code>: Flag indicating if regridding was performed (1) or not (0).</li><li><code>x_left::Vector{Float64}</code>: Updated left distance nodes.</li><li><code>x_right::Vector{Float64}</code>: Updated right distance nodes.</li><li><code>C_left::Vector{Float64}</code>: Updated composition values on the left nodes.</li><li><code>C_right::Vector{Float64}</code>: Updated composition values on the right nodes.</li><li><code>nr::Vector{Int}</code>: Updated resolution.</li><li><code>Ri::Float64</code>: Updated radii [interface    total length].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L4-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.blocktest-NTuple{4, Any}" href="#MovingBoundaryMinerals.blocktest-NTuple{4, Any}"><code>MovingBoundaryMinerals.blocktest</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">blocktest(L1, R1, L2, R2)</code></pre><p>Constructs a block matrix and a block vector from given input matrices and vectors.</p><p><strong>Arguments</strong></p><ul><li><code>L1::Matrix</code>: The first input matrix.</li><li><code>R1::Vector</code>: The first input vector.</li><li><code>L2::Matrix</code>: The second input matrix.</li><li><code>R2::Vector</code>: The second input vector.</li></ul><p><strong>Returns</strong></p><ul><li><code>Lblock::SparseMatrixCSC</code>: The block matrix constructed from <code>L1</code> and <code>L2</code>.</li><li><code>Rblock::Vector</code>: The block vector constructed from <code>R1</code> and <code>R2</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L97-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.calc_mass_err-Tuple{Any, Any}" href="#MovingBoundaryMinerals.calc_mass_err-Tuple{Any, Any}"><code>MovingBoundaryMinerals.calc_mass_err</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_mass_err(Mass, Mass0)</code></pre><p>Calculate the mass error between the final mass <code>Mass[end]</code> and the initial mass <code>Mass0</code>.</p><p><strong>Arguments</strong></p><ul><li><code>Mass::Vector</code>: A vector containing the mass values in [-].</li><li><code>Mass0::Number</code>: The initial mass value in [-].</li></ul><p><strong>Output</strong></p><ul><li><code>ErrM::Number</code>: The calculated mass error.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L170-L182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.calc_mass_vol-NTuple{6, Any}" href="#MovingBoundaryMinerals.calc_mass_vol-NTuple{6, Any}"><code>MovingBoundaryMinerals.calc_mass_vol</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_mass_vol(x_left, x_right, C_left, C_right, n, rho)</code></pre><p>Calculate the total mass based on the volume of the phase.</p><p><strong>Arguments</strong></p><ul><li><code>x_left::Float64</code>: Left nodes in [m].</li><li><code>x_right::Float64</code>: Right nodes in [m].</li><li><code>C_left::Vector{Float64}</code>: Composition values of the left phase in [-].</li><li><code>C_right::Vector{Float64}</code>: Composition values of the right phase in [-].</li><li><code>n::Int</code>: Number which defines the geometry.</li><li><code>rho::Vector{Float64}</code>: Densities of the left and right phase [kg/m³].</li></ul><p><strong>Returns</strong></p><ul><li><code>Mtot::Float64</code>: The total mass.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L189-L204">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.calc_volume-Tuple{Any, Any, Any}" href="#MovingBoundaryMinerals.calc_volume-Tuple{Any, Any, Any}"><code>MovingBoundaryMinerals.calc_volume</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_volume(x1, x2, ndim)</code></pre><p>Calculation of all volumes. The density in both phases is constant. Subsequently, shrinking and expanding volumes are not considered.</p><p><strong>Arguments</strong></p><ul><li><code>x1</code>: Nodes of the left phase.</li><li><code>x2</code>: Nodes of the right phase.</li><li><code>ndim</code>: Geometry factor.</li></ul><p><strong>Returns</strong></p><ul><li><code>V1</code>: Array of volumes for the left phase.</li><li><code>V2</code>: Array of volumes for the right phase.</li><li><code>dVC</code>: Array of total volume changes.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L256-L272">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.calculate_density-NTuple{7, Any}" href="#MovingBoundaryMinerals.calculate_density-NTuple{7, Any}"><code>MovingBoundaryMinerals.calculate_density</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_density(X_A, Y_A, rho_left, rho_right, C_leftB, C_rightB, T)</code></pre><p>Calculate the density of the phases at a given temperature <code>T</code> using interpolation in 2D.</p><p><strong>Arguments</strong></p><ul><li><code>X_A</code>: X-axis values for interpolation (composition X in [-])</li><li><code>Y_A</code>: Y-axis values for interpolation (temperature T in [K])</li><li><code>rho_left</code>: Left density values for interpolation in [kg/m^3]</li><li><code>rho_right</code>: Right density values for interpolation in [kg/m^3]</li><li><code>C_leftB</code>: Left composition values for interpolation in [-]</li><li><code>C_rightB</code>: Right composition values for interpolation in [-]</li><li><code>T</code>: Temperature at which to calculate the density in [K]</li></ul><p><strong>Returns</strong></p><ul><li><code>rho</code>: Array of normalized densities</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functionsStefan.jl#L5-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.coeff_trans_line-Tuple{Any}" href="#MovingBoundaryMinerals.coeff_trans_line-Tuple{Any}"><code>MovingBoundaryMinerals.coeff_trans_line</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">coeff_trans_line(eq_values)</code></pre><p>Extracts coefficients for linear least squares from the input <code>eq_values</code>.</p><p><strong>Arguments</strong></p><ul><li><code>eq_values</code>: A 2x3 matrix containing the coefficients for the upper and lower transition lines.</li></ul><p><strong>Returns</strong></p><ul><li><code>coeff_up</code>: A 1x3 vector containing the coefficients for the upper transition line.</li><li><code>coeff_do</code>: A 1x3 vector containing the coefficients for the lower transition line.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functionsStefan.jl#L34-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.composition-Tuple{Any, Any, Any}" href="#MovingBoundaryMinerals.composition-Tuple{Any, Any, Any}"><code>MovingBoundaryMinerals.composition</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">composition(coeff_up, coeff_do, T)</code></pre><p>Compute the composition of two components A and B at a given temperature.</p><p><strong>Arguments</strong></p><ul><li><code>coeff_up::Vector{Float64}</code>: Coefficients for the composition of component B.</li><li><code>coeff_do::Vector{Float64}</code>: Coefficients for the composition of component A.</li><li><code>T::Float64</code>: Temperature at which to compute the composition in [K].</li></ul><p><strong>Returns</strong></p><ul><li><code>C_left::Float64</code>: Composition of component A in [-].</li><li><code>C_right::Float64</code>: Composition of component B in [-].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functionsStefan.jl#L53-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.construct_matrix_fem-NTuple{9, Any}" href="#MovingBoundaryMinerals.construct_matrix_fem-NTuple{9, Any}"><code>MovingBoundaryMinerals.construct_matrix_fem</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">construct_matrix_fem(x_left, x_right, C_left, C_right, D_l, D_r, dt, n, res)</code></pre><p>Constructs the global matrix for the FEM solver in a diffusion couple problem. Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>x_left::Vector{Float64}</code>: Left grid spatial points in [m].</li><li><code>x_right::Vector{Float64}</code>: Right grid spatial points in [m].</li><li><code>C_left::Vector{Float64}</code>: Composition values of the left phase in [-].</li><li><code>C_right::Vector{Float64}</code>: Composition values of the right phase in [-].</li><li><code>D_l::Float64</code>: Diffusion coefficient on the left side in [m²/s].</li><li><code>D_r::Float64</code>: Diffusion coefficient on the right side in [m²/s].</li><li><code>dt::Float64</code>: Time step in [s].</li><li><code>n::Int</code>: Geometry definition.</li><li><code>res::Vector{Float64}</code>: Resolution.</li></ul><p><strong>Returns</strong></p><ul><li><code>L_g::SparseMatrixCSC{Float64, Int}</code>: Global stiffness matrix.</li><li><code>R_g::Vector{Float64}</code>: Global RHS vector.</li><li><code>Co_l::Vector{Float64}</code>: Stores left side composition values before the update.</li><li><code>Co_r::Vector{Float64}</code>: Stores right side composition values before the update.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L300-L322">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.create_grid!-NTuple{4, Any}" href="#MovingBoundaryMinerals.create_grid!-NTuple{4, Any}"><code>MovingBoundaryMinerals.create_grid!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_grid!(Ri, nr, MRefin,verbose)</code></pre><p>Create grid with or without variable spacing.Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>Ri::Vector{Float64}</code>: Initial radii [interface    total length] in [m].</li><li><code>nr::Vector{Int}</code>: Resolution vector.</li><li><code>MRefin::Int</code>: The refinement factor for the grid.</li><li><code>verbose::Bool</code>: A boolean indicating whether to print additional information.</li></ul><p><strong>Returns</strong></p><ul><li><code>x_left::Matrix{Float64}</code>: Left nodes in [m].</li><li><code>x_right::Matrix{Float64}</code>: Right nodes in [m].</li><li><code>dx1::Float64</code>: The grid spacing on the left side in [m].</li><li><code>dx2::Float64</code>: The grid spacing on the right side in [m].</li><li><code>x0::Matrix{Float64}</code>: Initial grid spacing for the whole domain in [m].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L345-L363">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.define_new_grid-NTuple{4, Any}" href="#MovingBoundaryMinerals.define_new_grid-NTuple{4, Any}"><code>MovingBoundaryMinerals.define_new_grid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">define_new_grid(Ri, nr, Rfact, verbose)</code></pre><p>This function defines a new grid based on the given parameters. Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>Ri</code>: Radii [interface    total length] in [m].</li><li><code>nr</code>: Resolution of nodes on the left and right side.</li><li><code>Rfact</code>: Grid refinement factor.</li><li><code>verbose</code>: A boolean indicating whether to print additional information.</li></ul><p><strong>Returns</strong></p><ul><li><code>Ri</code>: Radii [interface    total length] in [m].</li><li><code>nr</code>: Resolution of nodes on the left and right sides.</li><li><code>x_left</code>:Left nodes in [m].</li><li><code>x_right</code>: Right nodes in [m].</li><li><code>dx_left</code>: Left grid spacing in [m].</li><li><code>dx_right</code>: Right grid spacing in [m].</li><li><code>Sc_left</code>: The scaling factor for the left side.</li><li><code>Sc_right</code>: The scaling factor for the right side.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L372-L394">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.fill_matrix!-NTuple{6, Any}" href="#MovingBoundaryMinerals.fill_matrix!-NTuple{6, Any}"><code>MovingBoundaryMinerals.fill_matrix!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fill_matrix!(C, x, D, dt, ndim, nels)</code></pre><p>fill<em>matrix! function fills the global matrices L</em>g and R_g with the corresponding local matrices and vectors. Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>C</code>: Composition matrix in [-].</li><li><code>x</code>: Spatial grid  points.</li><li><code>D</code>: Diffusion coefficient in [m²/s].</li><li><code>dt</code>: Time step in [s].</li><li><code>ndim</code>: Geometry factor.</li><li><code>nels</code>: Number of elements.</li></ul><p><strong>Returns</strong></p><ul><li><code>L_g</code>: Global LHS matrix.</li><li><code>R_g</code>: Global RHS vector.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L492-L509">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.find_dt-NTuple{6, Any}" href="#MovingBoundaryMinerals.find_dt-NTuple{6, Any}"><code>MovingBoundaryMinerals.find_dt</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_dt(dx1, dx2, V_ip, D_l, D_r, CFL)</code></pre><p>Find the important time step <code>dt</code> based on the given parameters. The function calculates the time step <code>dt</code> based on the advection and diffusion properties of the system. Usually, advection time scale <code>dtV</code> are more dominat than diffusion time scale <code>dtD</code>. However, we included a dumping of dt, if <code>dt</code><code>&gt;</code>dtD<code>to ensure the visibility of diffusion processes within the code. If the advection velocity</code>V_ip<code>is zero,</code>dtD` is used instead. Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>dx1</code>: Left spatial step size next to the interface.</li><li><code>dx2</code>: Right spatial step size next to the interface.</li><li><code>V_ip</code>: The advection velocity in [m/s].</li><li><code>D_l</code>: The diffusion coefficient on the left side in [m²/s].</li><li><code>D_r</code>: The diffusion coefficient on the right side in [m²/s].</li><li><code>CFL</code>: The Courant-Friedrichs-Lewy number.</li></ul><p><strong>Returns</strong></p><ul><li><code>dt</code>: The calculated time step.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L443-L464">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.interp2-NTuple{5, Any}" href="#MovingBoundaryMinerals.interp2-NTuple{5, Any}"><code>MovingBoundaryMinerals.interp2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">interp2(X1d, Y1d, Z2d, xi, yi)</code></pre><p>Perform 2D bilinear interpolation within bounds.</p><p><strong>Arguments</strong></p><ul><li><code>X1d::Vector</code>: 1D monotonic (increasing) array representing the x-coordinates.</li><li><code>Y1d::Vector</code>: 1D monotonic (increasing) array representing the y-coordinates.</li><li><code>Z2d::Matrix</code>: 2D array representing the values to be interpolated.</li><li><code>xi::Vector</code>: 1D array of x-values to interpolate.</li><li><code>yi::Vector</code>: 1D array of y-values to interpolate.</li></ul><p><strong>Returns</strong></p><ul><li><code>zi::Vector</code>: 1D array of interpolated values corresponding to <code>xi</code> and <code>yi</code>.</li></ul><p><strong>Notes</strong></p><ul><li>The lengths of <code>xi</code> and <code>yi</code> must be the same.</li><li>The values in <code>xi</code> and <code>yi</code> should be within the bounds of <code>X1d</code> and <code>Y1d</code> respectively.</li><li>The function uses 2D bilinear interpolation to compute the interpolated values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functionsStefan.jl#L73-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.linear_interpolation_1D-Tuple{Any, Any, Any}" href="#MovingBoundaryMinerals.linear_interpolation_1D-Tuple{Any, Any, Any}"><code>MovingBoundaryMinerals.linear_interpolation_1D</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">linear_interpolation_1D(x, y, x_interp)</code></pre><p>Perform linear interpolation in 1D.</p><p><strong>Arguments</strong></p><ul><li><code>x::AbstractArray</code>: The x coordinates of data points.</li><li><code>y::AbstractArray</code>: The y coordinates of data points.</li><li><code>x_interp::Real</code>: The x coordinate at which interpolation is desired.</li></ul><p><strong>Returns</strong></p><ul><li><code>y_interp::Real</code>: The interpolated y value at <code>x_interp</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L551-L564">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.linspace_interface-NTuple{6, Any}" href="#MovingBoundaryMinerals.linspace_interface-NTuple{6, Any}"><code>MovingBoundaryMinerals.linspace_interface</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">linspace_interface(L1, L2, LIP, nx1, nx2, dX1_dXN)</code></pre><p>This function calculates the adaptive grid depending on the position of the interface. Note: This function assumes that <code>L1 &lt; L2</code> and <code>nx1 &lt;= nx2</code>. Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>L1</code>: Length of the left side in [m].</li><li><code>L2</code>: Length of the right side in [m].</li><li><code>LIP</code>: Interface position in [m].</li><li><code>nx1</code>: Number of nodes on the left side.</li><li><code>nx2</code>: Number of nodes on the right side.</li><li><code>dX1_dXN</code>: Ratio of the first grid spacing to the last grid spacing.</li></ul><p><strong>Returns</strong></p><ul><li><code>x_left</code>: Array of nodes on the left side in [m].</li><li><code>x_right</code>: Array of nodes on the right side in [m].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L587-L606">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.make_dx_right-Tuple{Any, Any, Any}" href="#MovingBoundaryMinerals.make_dx_right-Tuple{Any, Any, Any}"><code>MovingBoundaryMinerals.make_dx_right</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_dx_right(R, d1, n)</code></pre><p>Constructs an array containing the right side <code>dx</code>.</p><p><strong>Arguments</strong></p><ul><li><code>R::Number</code>: The common ratio to scale all <code>dx</code>.</li><li><code>d1::Number</code>: The initial value of <code>dx</code>.</li><li><code>n::Integer</code>: Number of <code>dx</code> elements.</li></ul><p><strong>Returns</strong></p><ul><li><code>dx::Array{Float64,1}</code>: Spatial distancenes for the right grid.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L694-L706">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.newton_solver-NTuple{6, Any}" href="#MovingBoundaryMinerals.newton_solver-NTuple{6, Any}"><code>MovingBoundaryMinerals.newton_solver</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">newton_solver(S, d, n, tol, max_iter, verbose)</code></pre><p>Solves the non-linear equation F(x) = (1 - x^n) / (1-x) - S / d using the Newton method.</p><p><strong>Arguments</strong></p><ul><li><code>S::Float64</code>: The value of S in the equation (scaling factor).</li><li><code>d::Float64</code>: The value of d in the equation (e.g. spatial distance).</li><li><code>n::Int</code>: The value of n in the equation (exponential factor).</li><li><code>tol::Float64</code>: The tolerance for convergence.</li><li><code>max_iter::Int</code>: The maximum number of iterations.</li><li><code>verbose::Bool</code>: Whether to print iteration information.</li></ul><p><strong>Returns</strong></p><ul><li><code>x::Float64</code>: The solution to the equation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L716-L731">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.pchip-Tuple{Any, Any, Any}" href="#MovingBoundaryMinerals.pchip-Tuple{Any, Any, Any}"><code>MovingBoundaryMinerals.pchip</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pchip(x, y, X)</code></pre><p>Shape-preserving piecewise Cubic Hermite Interpolating Polynomial.</p><p>This function computes the shape-preserving piecewise cubic Hermite interpolating polynomial for the given data points <code>(x, y)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>x::Vector</code>: The x-coordinates of the data points.</li><li><code>y::Vector</code>: The y-coordinates of the data points.</li><li><code>X::Vector</code>: The x-coordinates at which to evaluate the interpolating polynomial.</li></ul><p><strong>Returns</strong></p><ul><li><code>P::Vector</code>: The interpolated values at the points <code>X</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L759-L774">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.regrid!-NTuple{11, Any}" href="#MovingBoundaryMinerals.regrid!-NTuple{11, Any}"><code>MovingBoundaryMinerals.regrid!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">regrid!(Fl_regrid, x_left, x_right, C_left, C_right, Ri, V_ip, nr, nmin, MRefin, verbose)</code></pre><p>Regrid the grid and interpolate the composition profiles. Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>Fl_regrid::Int</code>: Flag indicating whether to regrid or not.</li><li><code>x_left::Vector</code>: Vector of left spatial nodes in [m].</li><li><code>x_right::Vector</code>: Vector of right spatial nodes in [m].</li><li><code>C_left::Vector</code>: Vector of left composition values in [-].</li><li><code>C_right::Vector</code>: Vector of right composition values in [-].</li><li><code>Ri::Vector</code>: Radii [interface    total length] in [m].</li><li><code>V_ip::Float64</code>: Velocity of the interface in [m/s].</li><li><code>nr::Vector</code>: Resolution.</li><li><code>nmin::Int</code>: Minimum grid size.</li><li><code>MRefin::Int</code>: Refinement factor.</li><li><code>verbose::Bool</code>: Whether to print additional information.</li></ul><p><strong>Returns</strong></p><ul><li><code>x_left::Matrix</code>: Matrix of left nodes in [m].</li><li><code>x_right::Matrix</code>: Matrix of right nodes in [m].</li><li><code>C_left::Vector</code>: Vector of left composition values in [-].</li><li><code>C_right::Vector</code>: Vector of right composition values in [-].</li><li><code>dx1::Float64</code>: Grid spacing at the left interface in [m].</li><li><code>dx2::Float64</code>: Grid spacing at the right interface in [m].</li><li><code>nr::Vector</code>: Updated resolution.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L841-L868">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.set_inner_bc_Lasaga!-NTuple{15, Any}" href="#MovingBoundaryMinerals.set_inner_bc_Lasaga!-NTuple{15, Any}"><code>MovingBoundaryMinerals.set_inner_bc_Lasaga!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_inner_bc_Lasaga!(Cl_i, beta, t, KD, D_r, D_l, D0, C_left, C_right, dx1, dx2, rho, L_g, R_g, nr)</code></pre><p>Set inner boundary conditions for the special case of major element diffusion in a diffusion couple (Lasaga, 1983). Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>Cl_i::Float64</code>: Initial composition on the left side in [-].</li><li><code>beta::Float64</code>: Variable from Lasagas semi-analytical solution.</li><li><code>t::Float64</code>: Time in [s].</li><li><code>KD::Float64</code>: Distribution coefficient.</li><li><code>D_r::Float64</code>: Diffusion coefficient on the right side in [m²/s].</li><li><code>D_l::Float64</code>: Diffusion coefficient on the left side in [m²/s].</li><li><code>D0::Array{Float64}</code>: Pre-exponential factor within the equation for the diffusion coefficient (<code>D</code>` at T0).</li><li><code>C_left::Array{Float64}</code>: Array of concentrations on the left side in [-].</li><li><code>C_right::Array{Float64}</code>: Array of concentrations on the right side in [-].</li><li><code>dx1::Float64</code>: Grid spacing on the left side in [m].</li><li><code>dx2::Float64</code>: Grid spacing on the right side in [m].</li><li><code>rho::Array{Float64}</code>: Array of densities in [kg/m³].</li><li><code>L_g::Array{Float64}</code>: Global left-hand side matrix.</li><li><code>R_g::Array{Float64}</code>: Global right-hand side vector.</li><li><code>nr::Array{Int64}</code>: Resolution.</li></ul><p><strong>Returns</strong></p><ul><li><code>L_g::Array{Float64}</code>: Updated global left-hand side matrix.</li><li><code>R_g::Array{Float64}</code>: Updated global right-hand side vector.</li><li><code>ScF::Float64</code>: Scaling factor.</li><li><code>BC_left::Float64</code>: Modelled left inner boundary condition (interface) in [-].</li><li><code>BC_right::Float64</code>: Modelled right inner boundary condition (interface) in [-].</li><li><code>BC_left_Las::Float64</code>: Left inner boundary condition following Lasaga (1983) in [-].</li><li><code>BC_right_Las::Float64</code>: Right inner boundary condition following Lasaga (1983) in [-].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L1111-L1142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.set_inner_bc_flux!-NTuple{10, Any}" href="#MovingBoundaryMinerals.set_inner_bc_flux!-NTuple{10, Any}"><code>MovingBoundaryMinerals.set_inner_bc_flux!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_inner_bc_flux!(L_g, R_g, KD, D_l, D_r, x_left, x_right, V_ip, rho, nr)</code></pre><p>Set the inner boundary conditions at the interface using fluxes. Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>L_g::Matrix</code>: The global matrix representing the system of equations (LHS).</li><li><code>R_g::Vector</code>: The global vector representing the right-hand side (RHS) of the system of equations.</li><li><code>KD::Float64</code>: The distribution coefficient.</li><li><code>D_l::Float64</code>: The diffusion coefficient on the left side in [m²/s].</li><li><code>D_r::Float64</code>: The diffusion coefficient on the right side in [m²/s].</li><li><code>x_left::Vector</code>: Left spatial nodes in [m].</li><li><code>x_right::Vector</code>: Right spatial nodes in [m].</li><li><code>V_ip::Float64</code>: The interface velocity in [m/s].</li><li><code>rho::Vector</code>: The density value in [kg/m³].</li><li><code>nr::Vector</code>: Resolution.</li></ul><p><strong>Returns</strong></p><ul><li><code>L_g::Matrix</code>: Updated LHS matrix.</li><li><code>R_g::Vector</code>: Updated RHS vector.</li><li><code>ScF::Float64</code>: The scale factor used to reduce the condition number.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L1030-L1053">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.set_inner_bc_mb!-NTuple{6, Any}" href="#MovingBoundaryMinerals.set_inner_bc_mb!-NTuple{6, Any}"><code>MovingBoundaryMinerals.set_inner_bc_mb!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_inner_bc_mb!(L_g, R_g, dVolC, Mtot, KD, nr)</code></pre><p>Set the inner boundary conditions at the interface using mass balance (MB). Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>L_g::Matrix</code>: The global matrix representing the system of equations (LHS).</li><li><code>R_g::Vector</code>: The global vector representing the right-hand side (RHS) of the system of equations.</li><li><code>dVolC::Vector</code>: The volume change vector in [m³].</li><li><code>Mtot::Float64</code>: The total mass in [-].</li><li><code>KD::Float64</code>: The distribution coefficient.</li><li><code>nr::Vector</code>: Resolution.</li></ul><p><strong>Returns</strong></p><ul><li><code>L_g::Matrix</code>: Updated LHS matrix.</li><li><code>R_g::Vector</code>: Updated RHS vector.</li><li><code>ScF::Float64</code>: The scale factor used to reduce the condition number.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L1074-L1093">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.set_inner_bc_stefan!-NTuple{5, Any}" href="#MovingBoundaryMinerals.set_inner_bc_stefan!-NTuple{5, Any}"><code>MovingBoundaryMinerals.set_inner_bc_stefan!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_inner_bc_stefan!(L_g, R_g, C_left, C_right, nr)</code></pre><p>Uses the Stefan boundary conditions to set the inner boundary conditions of the system of equations.</p><p><strong>Arguments</strong></p><ul><li><code>L_g::Matrix</code>: The matrix representing the left-hand side of the system of equations.</li><li><code>R_g::Vector</code>: The vector representing the right-hand side of the system of equations.</li><li><code>C_left::Vector</code>: Composition of the left phase in [-].</li><li><code>C_right::Vector</code>: Composition of the right phase in [-].</li><li><code>nr::Vector</code>: Resolution of the model.</li></ul><p><strong>Returns</strong></p><ul><li><code>L_g::Matrix</code>: The modified matrix <code>L_g</code> with Stefan conditions applied.</li><li><code>R_g::Vector</code>: The modified vector <code>R_g</code> with Stefan conditions applied.</li><li><code>ScF::Float64</code>: Scaling factor for reducing the condition number of the matrix.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functionsStefan.jl#L114-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.set_outer_bc!-NTuple{6, Any}" href="#MovingBoundaryMinerals.set_outer_bc!-NTuple{6, Any}"><code>MovingBoundaryMinerals.set_outer_bc!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_outer_bc!(BCout, L_g, R_g, C_left, C_right, ScF)</code></pre><p>Set the outer boundary conditions (Dirichlet or Neumann) for the diffusion-advection problem. Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>BCout</code>: An array indicating the type of boundary condition at the outer boundaries.</li><li><code>L_g</code>: The global left-hand side matrix of the diffusion-advection problem.</li><li><code>R_g</code>: The global right-hand side vector of the diffusion-advection problem.</li><li><code>C_left</code>: Composition vector of the left side in [-].</li><li><code>C_right</code>: Composition vector of the right side in [-].</li><li><code>ScF</code>: A scaling factor.</li></ul><p><strong>Details</strong></p><ul><li>If <code>BCout[1]</code> is equal to 1, the left outer boundary condition is Dirichlet, otherwise it is Neumann.</li><li>If <code>BCout[2]</code> is equal to 1, the right outer boundary condition is Dirichlet, otherwise it is Neumann.</li></ul><p><strong>Returns</strong></p><ul><li><code>L_g</code>: The updated global left-hand side matrix.</li><li><code>R_g</code>: The updated global right-hand side vector.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L1208-L1229">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.sinusoid_profile-NTuple{7, Any}" href="#MovingBoundaryMinerals.sinusoid_profile-NTuple{7, Any}"><code>MovingBoundaryMinerals.sinusoid_profile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sinusoid_profile(C0, n, L, D, t, G)</code></pre><p>Calculates a sinusoidal composition profile.</p><p>This function takes the initial composition <code>C0</code>, the number of sinusoidal modes <code>n</code>, the length of the system <code>L</code>, the diffusion coefficient <code>D</code>, the time <code>t</code>, and the amplitude <code>G</code> as input parameters. It calculates the composition profile at a given time <code>t</code> using the sinusoidal equation. Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>C0</code>: Initial composition at position x at `t = 0.0 in [-].</li><li><code>n</code>: Number of sinusoidal modes.</li><li><code>L</code>: Length of the modelling domain in [m].</li><li><code>D</code>: Diffusion coefficient in [m²/s].</li><li><code>t</code>: Time in [s].</li><li><code>G</code>: Amplitude.</li></ul><p><strong>Returns</strong></p><ul><li><code>C</code>: Composition profile at time <code>t</code> in [-].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L1245-L1265">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.solve_soe-Tuple{Any, Any, Any}" href="#MovingBoundaryMinerals.solve_soe-Tuple{Any, Any, Any}"><code>MovingBoundaryMinerals.solve_soe</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">solve_soe(L_g, R_g, res)</code></pre><p>Solves a system of equations.</p><p><strong>Arguments</strong></p><ul><li><code>L_g</code>: The left-hand side matrix of the system of equations.</li><li><code>R_g</code>: The right-hand side vector of the system of equations.</li><li><code>res</code>: Resolution.</li></ul><p><strong>Returns</strong></p><ul><li><code>C_left</code>: The updated composition vector of the left side in [-].</li><li><code>C_right</code>: The updated composition vector of the right side in [-].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L1276-L1289">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.trapezoidal_integration-Tuple{Any, Any}" href="#MovingBoundaryMinerals.trapezoidal_integration-Tuple{Any, Any}"><code>MovingBoundaryMinerals.trapezoidal_integration</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trapezoidal_integration(x, fx)</code></pre><p>Trapezoidal integration of <code>fx</code> over <code>x</code>.</p><p><strong>Arguments</strong></p><ul><li><code>x</code>: Array of x values.</li><li><code>fx</code>: Array of f(x) values.</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: The integrated value.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L1298-L1309">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.update_t_dependent_param!-NTuple{10, Any}" href="#MovingBoundaryMinerals.update_t_dependent_param!-NTuple{10, Any}"><code>MovingBoundaryMinerals.update_t_dependent_param!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_t_dependent_param!(D0, Di, Ea1, Ea2, KD_ar, R, T_ar, t_ar, t, t_tot)</code></pre><p>Update the time dependent parameters <code>D_l</code>, <code>D_r</code>, <code>KD</code>, and <code>T</code> based on the given inputs. If Di = [-1.0 -1.0], the diffusion coefficient will be calculated based on the Arrhenius relation. Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>D0::Vector{Float64}</code>: Pre-exponential factor within the calculation of the diffusion coefficient in [m²/s].</li><li><code>Di::Vector{Float64}</code>: Diffusion coefficients in [m²/s].</li><li><code>Ea1::Float64</code>: Activation energy for the left phase in [J/mol].</li><li><code>Ea2::Float64</code>: Activation energy for the right phase in [J/mol].</li><li><code>KD_ar::Vector{Float64}</code>: Array of distributioncoefficients.</li><li><code>R::Float64</code>: Gas constant in [J/(mol*K)].</li><li><code>T_ar::Vector{Float64}</code>: Array of temperatures in [K].</li><li><code>t_ar::Vector{Float64}</code>: Array of time in [s].</li><li><code>t::Float64</code>: Current time in [s].</li><li><code>t_tot::Float64</code>: Total time in [s].</li></ul><p><strong>Returns</strong></p><ul><li><code>D_l::Float64</code>: Updated diffusion coefficient for the left side in [m²/s].</li><li><code>D_r::Float64</code>: Updated diffusion coefficient for the right side in [m²/s].</li><li><code>KD::Float64</code>: Updated distribution coefficient.</li><li><code>T::Float64</code>: Updated temperature in [K].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L1325-L1349">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.update_t_dependent_param_simple!-NTuple{8, Any}" href="#MovingBoundaryMinerals.update_t_dependent_param_simple!-NTuple{8, Any}"><code>MovingBoundaryMinerals.update_t_dependent_param_simple!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_t_dependent_param_simple!(D0, Di, Ea1, R, T_ar, t_ar, t, t_tot)</code></pre><p>Update the dependent parameters <code>D</code> and <code>T</code> based on the given inputs. If Di = [-1.0], the diffusion coefficient will be calculated based on the Arrhenius relation. Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>D0</code>: Pre-exponential factor within the calculation of the diffusion coefficient in [m²/s].</li><li><code>Di</code>: Initial diffusion coefficient in [m²/s].</li><li><code>Ea1</code>: Activation energy in [J/mol].</li><li><code>R</code>: Gas constant in [J/(mol*K)].</li><li><code>T_ar</code>: Array of temperatures in [K].</li><li><code>t_ar</code>: Array of time in [s].</li><li><code>t</code>: Current time in [s].</li><li><code>t_tot</code>: Total time in [s].</li></ul><p><strong>Returns</strong></p><ul><li><code>D_l</code>: Updated diffusion coefficient in [m²/s].</li><li><code>T</code>: Updated temperature in [K].</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L1380-L1401">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MovingBoundaryMinerals.update_time!-NTuple{4, Any}" href="#MovingBoundaryMinerals.update_time!-NTuple{4, Any}"><code>MovingBoundaryMinerals.update_time!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_time!(t, dt, it, t_tot)</code></pre><p>Update the time and time  related variables <code>t</code>, <code>dt</code>, and <code>it</code> for a given total time <code>t_tot</code>. Units may differ from SI units if non-dimensionalisation has been performed.</p><p><strong>Arguments</strong></p><ul><li><code>t::Number</code>: Current time in [s].</li><li><code>dt::Number</code>: Time step in [s].</li><li><code>it::Integer</code>: Time iterations.</li><li><code>t_tot::Number</code>: Total time in [s].</li></ul><p><strong>Returns</strong></p><ul><li><code>t::Number</code>: Updated time in [s].</li><li><code>dt::Number</code>: Updated time step in [s].</li><li><code>it::Integer</code>: Updated time iterations.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AnStroh/MovingBoundaryMinerals.jl/blob/6ce68e5052aa5e4a4921388f6a290d9ce2177032/src/functions.jl#L1425-L1441">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../listexamples/">« List of examples</a><a class="docs-footer-nextpage" href="../authors/">Authors »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Tuesday 27 May 2025 13:16">Tuesday 27 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
